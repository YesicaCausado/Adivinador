<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üéµ Adivina la Canci√≥n</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #1f1c2c, #928dab);
      color: #fff;
    }

    .game-container {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      width: 400px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      animation: fadeIn 1s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h1 {
      font-size: 28px;
      margin-bottom: 20px;
      font-weight: 700;
      color: #f5f5f5;
    }

    #player {
      margin: 15px 0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    }

    button {
      margin: 10px;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(135deg, #ff9966, #ff5e62);
      color: white;
      font-size: 16px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    button:hover {
      transform: translateY(-3px) scale(1.05);
      background: linear-gradient(135deg, #ff5e62, #ff9966);
      box-shadow: 0 5px 20px rgba(255, 100, 120, 0.5);
    }

    #options button {
      display: block;
      width: 100%;
      margin: 8px 0;
      background: linear-gradient(135deg, #36d1dc, #5b86e5);
    }

    #options button:hover {
      background: linear-gradient(135deg, #5b86e5, #36d1dc);
    }

    #message {
      margin-top: 15px;
      font-weight: 600;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>üéµ Adivina la Canci√≥n</h1>
    <div id="player"></div>
    <button onclick="playSnippet()">‚ñ∂ Reproducir fragmento</button>
    <div id="options"></div>
    <div id="message"></div>
  </div>

  <!-- YouTube API -->
  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    const API_KEY = "AIzaSyBWM6ZPP0ZG-I8yZJD3oE5C3ap52JCyCFQ"; // Pega aqu√≠ tu API Key
    let player, correctTitle = "";
    
    async function fetchPopularSongs() {
      const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&chart=mostPopular&type=video&videoCategoryId=10&maxResults=5&key=${API_KEY}`);
      const data = await res.json();
      return data.items;
    }

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '200',
        width: '300',
        videoId: '',
        playerVars: { autoplay: 0 }
      });
    }

    async function loadGame() {
      const songs = await fetchPopularSongs();
      const randomIndex = Math.floor(Math.random() * songs.length);
      const chosenSong = songs[randomIndex];
      correctTitle = chosenSong.snippet.title;

      player.loadVideoById(chosenSong.id.videoId);
      player.stopVideo();

      const optionsDiv = document.getElementById('options');
      optionsDiv.innerHTML = "";

      let options = [correctTitle];
      while (options.length < 4) {
        let randomSong = songs[Math.floor(Math.random() * songs.length)].snippet.title;
        if (!options.includes(randomSong)) options.push(randomSong);
      }
      options = options.sort(() => Math.random() - 0.5);

      options.forEach(title => {
        const btn = document.createElement("button");
        btn.textContent = title;
        btn.onclick = () => checkAnswer(title);
        optionsDiv.appendChild(btn);
      });

      document.getElementById("message").textContent = "";
    }

    function playSnippet() {
      player.playVideo();
      setTimeout(() => {
        player.pauseVideo();
      }, 10000); // 10 segundos de snippet
    }

    function checkAnswer(selected) {
      const message = document.getElementById("message");
      if (selected === correctTitle) {
        message.textContent = "‚úÖ ¬°Correcto!";
        message.style.color = "#4CAF50";
      } else {
        message.textContent = "‚ùå Incorrecto. Era: " + correctTitle;
        message.style.color = "#ff4d4d";
      }
      setTimeout(loadGame, 3000);
    }

    loadGame();
  </script>
</body>
</html>
